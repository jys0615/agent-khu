# ì•„í‚¤í…ì²˜ ğŸ“

Agent KHUì˜ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ë¥¼ ìƒì„¸íˆ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## ğŸ“‹ ëª©ì°¨

- [ì „ì²´ êµ¬ì¡°](#ì „ì²´-êµ¬ì¡°)
- [Agentic AI ì›Œí¬í”Œë¡œìš°](#agentic-ai-ì›Œí¬í”Œë¡œìš°)
- [MCP í”„ë¡œí† ì½œ](#mcp-í”„ë¡œí† ì½œ)
- [ë°±ì—”ë“œ ì•„í‚¤í…ì²˜](#ë°±ì—”ë“œ-ì•„í‚¤í…ì²˜)
- [í”„ë¡ íŠ¸ì—”ë“œ ì•„í‚¤í…ì²˜](#í”„ë¡ íŠ¸ì—”ë“œ-ì•„í‚¤í…ì²˜)
- [ë°ì´í„° í”Œë¡œìš°](#ë°ì´í„°-í”Œë¡œìš°)
- [ë³´ì•ˆ ì„¤ê³„](#ë³´ì•ˆ-ì„¤ê³„)
- [í™•ì¥ì„±](#í™•ì¥ì„±)

---

## ì „ì²´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ì‚¬ìš©ì (í•™ìƒ)                           â”‚
â”‚               "ìë£Œêµ¬ì¡°ëŠ” ëª‡ í•™ì ì´ì•¼?"                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTPS
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚    React Frontend             â”‚
         â”‚    (Vite + TypeScript)        â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  ChatInterface.tsx       â”‚ â”‚
         â”‚  â”‚  - ë©”ì‹œì§€ ë Œë”ë§         â”‚ â”‚
         â”‚  â”‚  - ì‹¤ì‹œê°„ íƒ€ì´í•‘         â”‚ â”‚
         â”‚  â”‚  - ì§€ë„/í…Œì´ë¸” í‘œì‹œ      â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTP/REST
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   FastAPI Backend             â”‚
         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
         â”‚   â”‚  main.py               â”‚  â”‚
         â”‚   â”‚  - CORS                â”‚  â”‚
         â”‚   â”‚  - Lifespan ê´€ë¦¬       â”‚  â”‚
         â”‚   â”‚  - ë¼ìš°í„° ë“±ë¡         â”‚  â”‚
         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
         â”‚            â”‚                   â”‚
         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
         â”‚   â”‚  /api/chat             â”‚  â”‚
         â”‚   â”‚  (chat router)         â”‚  â”‚
         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Agent (agent.py)         â”‚
         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚   â”‚  Claude Sonnet 4   â”‚   â”‚
         â”‚   â”‚  - Tool Selection  â”‚   â”‚
         â”‚   â”‚  - Context Mgmt    â”‚   â”‚
         â”‚   â”‚  - Response Gen    â”‚   â”‚
         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â”‚            â”‚ (ìµœëŒ€ 5íšŒ ë°˜ë³µ)â”‚
         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚   â”‚  Tool Executor     â”‚   â”‚
         â”‚   â”‚  - process_tool    â”‚   â”‚
         â”‚   â”‚  - ê²°ê³¼ ëˆ„ì        â”‚   â”‚
         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   MCP Client               â”‚
         â”‚   (mcp_client.py)          â”‚
         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
         â”‚   â”‚  - stdio í†µì‹       â”‚   â”‚
         â”‚   â”‚  - íƒ€ì„ì•„ì›ƒ ê´€ë¦¬   â”‚   â”‚
         â”‚   â”‚  - Lazy start      â”‚   â”‚
         â”‚   â”‚  - ì‘ë‹µ íŒŒì‹±       â”‚   â”‚
         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ JSON-RPC 2.0
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                 â”‚                 â”‚
    â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚curriculumâ”‚     â”‚ notice  â”‚ ... â”‚ course  â”‚  (9ê°œ MCP ì„œë²„)
â”‚  -mcp   â”‚     â”‚  -mcp   â”‚     â”‚  -mcp   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚               â”‚               â”‚
     â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ë°ì´í„° ì†ŒìŠ¤                             â”‚
â”‚   - PostgreSQL                           â”‚
â”‚   - Web Crawling (Playwright, Requests) â”‚
â”‚   - Static JSON                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Agentic AI ì›Œí¬í”Œë¡œìš°

### í•µì‹¬ ê°œë…

Agent KHUëŠ” **Tool-Use íŒ¨í„´**ì„ í™œìš©í•œ **Agentic AI** ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

```python
# agent.pyì˜ í•µì‹¬ ë¡œì§
while iteration < max_iterations:
    # 1. Claudeì—ê²Œ ë©”ì‹œì§€ ì „ì†¡
    response = client.messages.create(
        model="claude-sonnet-4-20250514",
        messages=messages,
        tools=tools  # ì‚¬ìš© ê°€ëŠ¥í•œ Tool ëª©ë¡
    )
    
    # 2. Claudeê°€ Tool ì‚¬ìš© ê²°ì •
    if response.stop_reason == "tool_use":
        for content in response.content:
            if content.type == "tool_use":
                # 3. Tool ì‹¤í–‰
                result = await process_tool_call(
                    content.name,
                    content.input
                )
                
                # 4. ê²°ê³¼ë¥¼ Claudeì—ê²Œ ë‹¤ì‹œ ì „ë‹¬
                tool_results.append({
                    "type": "tool_result",
                    "tool_use_id": content.id,
                    "content": json.dumps(result)
                })
        
        # 5. ëŒ€í™” ì´ë ¥ ì—…ë°ì´íŠ¸ (ë‹¤ìŒ ë°˜ë³µì— ì‚¬ìš©)
        messages.append({"role": "assistant", "content": response.content})
        messages.append({"role": "user", "content": tool_results})
    
    # 6. Claudeê°€ ìµœì¢… ì‘ë‹µ ìƒì„±
    elif response.stop_reason == "end_turn":
        return final_response
```

### ì‹¤í–‰ ì˜ˆì‹œ

**ì‚¬ìš©ì ì§ˆë¬¸**: "ìë£Œêµ¬ì¡°ëŠ” ëª‡ í•™ì ì´ê³  1í•™ê¸°ì— ë“¤ì„ ìˆ˜ ìˆì–´?"

**Iteration 1**
```
User: "ìë£Œêµ¬ì¡°ëŠ” ëª‡ í•™ì ì´ê³  1í•™ê¸°ì— ë“¤ì„ ìˆ˜ ìˆì–´?"
    â†“
Claude: [Tool ì„ íƒ] â†’ search_curriculum(query="ìë£Œêµ¬ì¡°")
    â†“
MCP Client: curriculum-mcp í˜¸ì¶œ
    â†“
Result: {
    "code": "CSE204",
    "name": "ìë£Œêµ¬ì¡°",
    "credits": 3,
    "semesters": ["1", "2"]
}
    â†“
Claude: [ì¶©ë¶„í•œ ì •ë³´ í™•ë³´] â†’ end_turn
    â†“
Response: "ìë£Œêµ¬ì¡°ëŠ” 3í•™ì  ê³¼ëª©ì´ë©°, 1í•™ê¸°ì™€ 2í•™ê¸° ëª¨ë‘ ìˆ˜ê°• ê°€ëŠ¥í•©ë‹ˆë‹¤."
```

**ë³µì¡í•œ ì§ˆë¬¸**: "ë‚´ì¼ í•™ì‹ ë©”ë‰´ ì•Œë ¤ì£¼ê³ , ì‹ë‹¹ ìœ„ì¹˜ë„ ì•Œë ¤ì¤˜"

**Iteration 1**
```
Claude: [Tool ì„ íƒ] â†’ search_meals(query="ë‚´ì¼")
Result: [í•™ì‹ ë©”ë‰´ ë°ì´í„°]
```

**Iteration 2**
```
Claude: [ì¶”ê°€ Tool í•„ìš”] â†’ search_room(query="ì‹ë‹¹")
Result: [ì‹ë‹¹ ìœ„ì¹˜ ì •ë³´]
```

**Iteration 3**
```
Claude: [ì¶©ë¶„í•œ ì •ë³´ í™•ë³´] â†’ end_turn
Response: "ë‚´ì¼ ë©”ë‰´ëŠ”... í•™ìƒì‹ë‹¹ì€ ë³¸ê´€ 1ì¸µì— ìˆìŠµë‹ˆë‹¤."
```

### ë¬´í•œ ë£¨í”„ ë°©ì§€

```python
max_iterations = 5  # ìµœëŒ€ 5íšŒ ë°˜ë³µ

if iteration >= max_iterations:
    # ê°•ì œ ì¢…ë£Œ í›„ í˜„ì¬ê¹Œì§€ì˜ ì •ë³´ë¡œ ì‘ë‹µ ìƒì„±
    return fallback_response
```

---

## MCP í”„ë¡œí† ì½œ

### JSON-RPC 2.0 í‘œì¤€

```json
// ìš”ì²­ (stdin)
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "tools/call",
  "params": {
    "name": "search_courses",
    "arguments": {"query": "ìë£Œêµ¬ì¡°"}
  }
}

// ì‘ë‹µ (stdout)
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "content": [
      {
        "type": "text",
        "text": "{\"code\": \"CSE204\", ...}"
      }
    ],
    "isError": false
  }
}
```

### ì´ˆê¸°í™” ì‹œí€€ìŠ¤

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚                    â”‚  Server  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚                               â”‚
      â”‚  initialize                   â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
      â”‚                               â”‚
      â”‚  result (capabilities)        â”‚
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
      â”‚                               â”‚
      â”‚  notifications/initialized    â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
      â”‚                               â”‚
      â”‚  (ì„œë²„ ì¤€ë¹„ ì™„ë£Œ)             â”‚
      â”‚                               â”‚
      â”‚  tools/list                   â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
      â”‚                               â”‚
      â”‚  result (tools)               â”‚
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
      â”‚                               â”‚
      â”‚  tools/call                   â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
      â”‚                               â”‚
      â”‚  result (data)                â”‚
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
```

### Lazy Start

```python
# mcp_client.py
async def _ensure_server(self, server_name: str):
    """ì„œë²„ê°€ ì—†ìœ¼ë©´ ìë™ ì‹œì‘"""
    if server_name not in self.servers:
        path = self.server_paths.get(server_name)
        await self.start_server(server_name, path)
```

**ì¥ì **:
- ë¶ˆí•„ìš”í•œ ì„œë²„ëŠ” ì‹œì‘í•˜ì§€ ì•ŠìŒ
- ë©”ëª¨ë¦¬ ì ˆì•½
- ì‹œì‘ ì‹œê°„ ë‹¨ì¶•

---

## ë°±ì—”ë“œ ì•„í‚¤í…ì²˜

### ê³„ì¸µ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Presentation Layer           â”‚  (FastAPI Router)
â”‚   - /api/auth                      â”‚
â”‚   - /api/chat                      â”‚
â”‚   - /api/classrooms                â”‚
â”‚   - /api/notices                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Business Logic Layer         â”‚
â”‚   - agent.py (AI Agent)            â”‚
â”‚   - mcp_client.py (MCP í†µì‹ )       â”‚
â”‚   - crud.py (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)        â”‚
â”‚   - auth.py (ì¸ì¦/ì¸ê°€)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Data Access Layer            â”‚
â”‚   - models.py (SQLAlchemy ëª¨ë¸)   â”‚
â”‚   - database.py (DB ì—°ê²°)          â”‚
â”‚   - schemas.py (Pydantic ìŠ¤í‚¤ë§ˆ)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Data Sources                 â”‚
â”‚   - PostgreSQL                     â”‚
â”‚   - MCP Servers                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì˜ì¡´ì„± ì£¼ì…

```python
# FastAPI Depends íŒ¨í„´
@router.post("/chat")
async def chat_endpoint(
    message: str,
    db: Session = Depends(get_db),           # DB ì„¸ì…˜
    current_user: User = Depends(get_current_user)  # ì¸ì¦ëœ ì‚¬ìš©ì
):
    result = await chat_with_claude_async(
        message, 
        db, 
        current_user
    )
    return result
```

---

## í”„ë¡ íŠ¸ì—”ë“œ ì•„í‚¤í…ì²˜

### ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

```
App.tsx
 â””â”€ ChatInterface.tsx
     â”œâ”€ MessageList
     â”‚   â”œâ”€ UserMessage
     â”‚   â””â”€ AssistantMessage
     â”œâ”€ InputBox
     â”œâ”€ MapView (ì¡°ê±´ë¶€ ë Œë”ë§)
     â”œâ”€ NoticeList (ì¡°ê±´ë¶€ ë Œë”ë§)
     â””â”€ CourseTable (ì¡°ê±´ë¶€ ë Œë”ë§)
```

### ìƒíƒœ ê´€ë¦¬

```typescript
// ChatInterface.tsx
const [messages, setMessages] = useState<Message[]>([]);
const [inputValue, setInputValue] = useState("");
const [isLoading, setIsLoading] = useState(false);
const [mapData, setMapData] = useState(null);
const [noticeData, setNoticeData] = useState([]);
```

### API í†µì‹ 

```typescript
// api/chat.ts
export async function sendMessage(message: string): Promise<ChatResponse> {
    const response = await axios.post('/api/chat', {
        message,
        user_latitude: latitude,
        user_longitude: longitude
    });
    
    return response.data;
}
```

---

## ë°ì´í„° í”Œë¡œìš°

### 1. ì±„íŒ… ë©”ì‹œì§€ í”Œë¡œìš°

```
ì‚¬ìš©ì ì…ë ¥
    â†“
React State ì—…ë°ì´íŠ¸
    â†“
axios.post('/api/chat')
    â†“
FastAPI /api/chat ì—”ë“œí¬ì¸íŠ¸
    â†“
agent.chat_with_claude_async()
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agent Loop (ìµœëŒ€ 5íšŒ)â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Claude í˜¸ì¶œ   â”‚  â”‚
â”‚  â”‚ â†“             â”‚  â”‚
â”‚  â”‚ Tool ì„ íƒ     â”‚  â”‚
â”‚  â”‚ â†“             â”‚  â”‚
â”‚  â”‚ MCP í˜¸ì¶œ      â”‚  â”‚
â”‚  â”‚ â†“             â”‚  â”‚
â”‚  â”‚ ê²°ê³¼ ëˆ„ì      â”‚  â”‚
â”‚  â”‚ â†“             â”‚  â”‚
â”‚  â”‚ ì¬í‰ê°€        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
ìµœì¢… ì‘ë‹µ êµ¬ì„±
    â†“
JSON Response
    â†“
React State ì—…ë°ì´íŠ¸
    â†“
UI ë Œë”ë§
```

### 2. MCP ì„œë²„ í˜¸ì¶œ í”Œë¡œìš°

```python
# agent.py
result = await mcp_client.call_tool(
    "curriculum",           # ì„œë²„ ì´ë¦„
    "search_courses",       # Tool ì´ë¦„
    {"query": "ìë£Œêµ¬ì¡°"}   # ì¸ì
)
    â†“
# mcp_client.py
await _ensure_server("curriculum")  # Lazy start
    â†“
# JSON-RPC ìš”ì²­ êµ¬ì„±
request = {
    "jsonrpc": "2.0",
    "id": 2,
    "method": "tools/call",
    "params": {
        "name": "search_courses",
        "arguments": {"query": "ìë£Œêµ¬ì¡°"}
    }
}
    â†“
# stdioë¡œ ì „ì†¡
process.stdin.write(json.dumps(request) + "\n")
    â†“
# curriculum-mcp/server.py
async def tool_search_courses(args):
    query = args["query"]
    # í¬ë¡¤ë§/DB ì¡°íšŒ
    return results
    â†“
# JSON-RPC ì‘ë‹µ
{
    "jsonrpc": "2.0",
    "id": 2,
    "result": {
        "content": [{"type": "text", "text": "..."}]
    }
}
    â†“
# mcp_client.py: íŒŒì‹±
parsed = _parse_result_text(response["result"])
    â†“
# agent.py: ê²°ê³¼ ëˆ„ì 
accumulated_results["curriculum_courses"].append(parsed)
```

---

## ë³´ì•ˆ ì„¤ê³„

### ì¸ì¦ & ì¸ê°€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JWT í† í° ê¸°ë°˜ ì¸ì¦                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. ë¡œê·¸ì¸ (POST /api/auth/login)    â”‚
â”‚     â””â”€> JWT í† í° ë°œê¸‰                â”‚
â”‚                                       â”‚
â”‚  2. ë³´í˜¸ëœ ì—”ë“œí¬ì¸íŠ¸ ì ‘ê·¼            â”‚
â”‚     â””â”€> Authorization: Bearer TOKEN  â”‚
â”‚     â””â”€> get_current_user() ê²€ì¦      â”‚
â”‚                                       â”‚
â”‚  3. í† í° ë§Œë£Œ (1ì‹œê°„)                â”‚
â”‚     â””â”€> ì¬ë¡œê·¸ì¸ í•„ìš”                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë¹„ë°€ë²ˆí˜¸ í•´ì‹±

```python
# auth.py
from passlib.context import CryptContext

pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

# í•´ì‹±
hashed = pwd_context.hash(plain_password)

# ê²€ì¦
pwd_context.verify(plain_password, hashed_password)
```

### CORS ì •ì±…

```python
# main.py
app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:5173"],  # ëª…ì‹œì  í—ˆìš©
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

### í™˜ê²½ë³€ìˆ˜ ë³´í˜¸

```python
# .gitignore
.env
*.env
**/.env
```

---

## í™•ì¥ì„±

### 1. ìƒˆ MCP ì„œë²„ ì¶”ê°€

```python
# mcp_client.py
self.server_paths.update({
    "new_mcp": self.mcp_dir / "new-mcp/server.py"
})

# agent.py
tools.append({
    "name": "new_tool",
    "description": "...",
    "input_schema": {...}
})
```

### 2. ìƒˆ API ì—”ë“œí¬ì¸íŠ¸

```python
# routers/new_router.py
@router.get("/new")
async def new_endpoint():
    return {"message": "new"}

# main.py
app.include_router(new_router)
```

### 3. ìˆ˜í‰ í™•ì¥

```
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ Load Balancerâ”‚
                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Backend1â”‚      â”‚Backend2â”‚      â”‚Backend3â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  PostgreSQL   â”‚
                 â”‚  (Primary +   â”‚
                 â”‚   Replicas)   â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì£¼ì˜ì‚¬í•­**:
- MCP ì„œë²„ëŠ” ê° ë°±ì—”ë“œ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ë…ë¦½ ì‹¤í–‰
- DB ì»¤ë„¥ì…˜ í’€ ì ì ˆíˆ ì„¤ì •
- ì„¸ì…˜ ìŠ¤í† ì–´ ê³ ë ¤ (Redis ë“±)

---

## ì„±ëŠ¥ ìµœì í™”

### 1. MCP ì„œë²„ ìºì‹±

```python
# curriculum-mcp/server.py
CACHE_PATH = Path(__file__).parent / "data/curriculum_data.json"

def load_data():
    if CACHE_PATH.exists():
        with open(CACHE_PATH) as f:
            return json.load(f)
    # í¬ë¡¤ë§...
```

### 2. DB ì¸ë±ìŠ¤

```python
# models.py
class Notice(Base):
    __table_args__ = (
        Index('idx_notice_search', 'title', 'content'),
        Index('idx_notice_date', 'date'),
    )
```

### 3. ë¹„ë™ê¸° ì²˜ë¦¬

```python
# agent.py
async def chat_with_claude_async(...):
    # ëª¨ë“  I/O ì‘ì—… ë¹„ë™ê¸°
    result = await mcp_client.call_tool(...)
```

---

## ë‹¤ìŒ ë‹¨ê³„

- [MCP ì„œë²„ ê°œë°œ ê°€ì´ë“œ](MCP_SERVERS.md)
- [API ë¬¸ì„œ](API.md)
- [ë°°í¬ ê°€ì´ë“œ](DEPLOYMENT.md)